sudo: required

dist: trusty

langauge: node_js
node_js:
  - "lts/*"

services:
  - mysql

addons:
  apt:
    packages:
    - mysql-server-5.6
    - mysql-client-core-5.6
    - mysql-client-5.6

before_install:
  - npm install -g npm

before_script:
  - npm install
  - mysql -u root -e 'CREATE DATABASE test_db'
  - mysql -u root -e "CREATE USER 'test_user'@'localhost' IDENTIFIED BY 'test_pass'";
  - mysql -u root -e "GRANT ALL ON *.* TO 'test_user'@'localhost';"
  - mysql -u root -e 'FLUSH PRIVILEGES;'
  - DB_USER=test_user
  - DB_NAME=test_db
  - DB_PASS=test_pass

script: npm run test